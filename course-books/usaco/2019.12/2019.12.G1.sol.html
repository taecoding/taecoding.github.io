
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>Gold 1 solution Â· GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-collapsible-chapters/collapsible-chapters.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="2019.12.G2.sol.html" />
    
    
    <link rel="prev" href="2019.12.G3.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" >
            
                <span>
            
                    
                    [2019]
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1" >
            
                <span>
            
                    
                    [December-Bronze]
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1.1" data-path="2019.12.B1.html">
            
                <a href="2019.12.B1.html">
            
                    
                    Bronze 1
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.1.2" data-path="2019.12.B2.html">
            
                <a href="2019.12.B2.html">
            
                    
                    Bronze 2
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.1.3" data-path="2019.12.B3.html">
            
                <a href="2019.12.B3.html">
            
                    
                    Bronze 3
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.1.4" data-path="2019.12.B1.sol.md">
            
                <span>
            
                    
                    Bronze 1 solution
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.1.5" data-path="2019.12.B2.sol.md">
            
                <span>
            
                    
                    Bronze 2 solution
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.1.6" data-path="2019.12.B3.sol.md">
            
                <span>
            
                    
                    Bronze 3 solution
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.2.2" >
            
                <span>
            
                    
                    [December-Bilver]
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.2.1" data-path="2019.12.S1.html">
            
                <a href="2019.12.S1.html">
            
                    
                    Silver 1
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2.2" data-path="2019.12.S2.html">
            
                <a href="2019.12.S2.html">
            
                    
                    Silver 2
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2.3" data-path="2019.12.S3.html">
            
                <a href="2019.12.S3.html">
            
                    
                    Silver 3
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2.4" data-path="2019.12.S1.sol.html">
            
                <a href="2019.12.S1.sol.html">
            
                    
                    Silver 1 solution
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2.5" data-path="2019.12.S2.sol.html">
            
                <a href="2019.12.S2.sol.html">
            
                    
                    Silver 2 solution
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2.6" data-path="2019.12.S3.sol.html">
            
                <a href="2019.12.S3.sol.html">
            
                    
                    Silver 3 solution
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.2.3" >
            
                <span>
            
                    
                    [December-Gold]
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.3.1" data-path="2019.12.G1.html">
            
                <a href="2019.12.G1.html">
            
                    
                    Gold 1
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.3.2" data-path="2019.12.G2.html">
            
                <a href="2019.12.G2.html">
            
                    
                    Gold 2
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.3.3" data-path="2019.12.G3.html">
            
                <a href="2019.12.G3.html">
            
                    
                    Gold 3
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="1.2.3.4" data-path="2019.12.G1.sol.html">
            
                <a href="2019.12.G1.sol.html">
            
                    
                    Gold 1 solution
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.3.5" data-path="2019.12.G2.sol.html">
            
                <a href="2019.12.G2.sol.html">
            
                    
                    Gold 2 solution
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.3.6" data-path="2019.12.G3.sol.html">
            
                <a href="2019.12.G3.sol.html">
            
                    
                    Gold 3 solution
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3" >
            
                <span>
            
                    
                    [2020]
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1" >
            
                <span>
            
                    
                    [December-Silver]
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1.1" data-path="../2020.01/2020.01.S1.html">
            
                <a href="../2020.01/2020.01.S1.html">
            
                    
                    Silver 1
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.1.2" data-path="../2020.01/2020.01.S2.html">
            
                <a href="../2020.01/2020.01.S2.html">
            
                    
                    Silver 2
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.1.3" data-path="../2020.01/2020.01.S3.html">
            
                <a href="../2020.01/2020.01.S3.html">
            
                    
                    Silver 3
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.1.4" data-path="../2020.01/2020.01.S1.sol.html">
            
                <a href="../2020.01/2020.01.S1.sol.html">
            
                    
                    Silver 1 solution
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.1.5" data-path="../2020.01/2020.01.S2.sol.html">
            
                <a href="../2020.01/2020.01.S2.sol.html">
            
                    
                    Silver 2 solution
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.1.6" data-path="../2020.01/2020.01.S3.sol.html">
            
                <a href="../2020.01/2020.01.S3.sol.html">
            
                    
                    Silver 3 solution
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3.2" >
            
                <span>
            
                    
                    [December-Gold]
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.2.1" data-path="../2020.01/2020.01.G1.html">
            
                <a href="../2020.01/2020.01.G1.html">
            
                    
                    Gold 1
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2.2" data-path="../2020.01/2020.01.G2.html">
            
                <a href="../2020.01/2020.01.G2.html">
            
                    
                    Gold 2
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2.3" data-path="../2020.01/2020.01.G3.html">
            
                <a href="../2020.01/2020.01.G3.html">
            
                    
                    Gold 3
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2.4" data-path="../2020.01/2020.01.G1.sol.html">
            
                <a href="../2020.01/2020.01.G1.sol.html">
            
                    
                    Gold 1 solution
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2.5" data-path="../2020.01/2020.01.G2.sol.html">
            
                <a href="../2020.01/2020.01.G2.sol.html">
            
                    
                    Gold 2 solution
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2.6" data-path="../2020.01/2020.01.G3.sol.html">
            
                <a href="../2020.01/2020.01.G3.sol.html">
            
                    
                    Gold 3 solution
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >Gold 1 solution</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <p>(Analysis by Nick Wu)
Let&apos;s first approach a simpler problem - what is the minimum cost needed to reach junction N from junction 1, ignoring flow rate? This is a shortest paths problem and can be solved by applying Dijkstra&apos;s.</p>
<p>There&apos;s a small problem though - if we just use Dijkstra&apos;s to compute the length of the shortest path, we don&apos;t know which edges are used so we can&apos;t compute the ratio of flow rate and cost directly. We need more information about the minimum weight edge used in the graph.</p>
<p>There are two ways that we can handle this. The first way is to delete all edges with the minimum weight, and recompute the length of the shortest path. We repeatedly apply this process until there is no path between junctions 1 and N. For each application of Dijkstra&apos;s, compute the ratio between the minimum weight edge present in the graph and the length of the shortest path, and take the maximum of all of these values.</p>
<p>This answer is clearly a lower bound on the answer since it cannot overestimate the flow rate within the graph, and the reason that this answer must be valid is that if the length of the shortest path increases after deleting edges of minimum weight, then all shortest paths in the prior graph must have used one of those edges.</p>
<p>Here is Brian Dean&apos;s code implementing this approach.</p>
<pre><code class="lang-cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;fstream&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;vector&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;set&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;map&gt;</span></span>
<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> <span class="hljs-built_in">std</span>;

<span class="hljs-keyword">int</span> N, M;
<span class="hljs-built_in">map</span>&lt;<span class="hljs-keyword">int</span>, <span class="hljs-built_in">vector</span>&lt;<span class="hljs-keyword">int</span>&gt;&gt; nbrs;
<span class="hljs-built_in">map</span>&lt;pair&lt;<span class="hljs-keyword">int</span>,<span class="hljs-keyword">int</span>&gt;,<span class="hljs-keyword">double</span>&gt; edgecost;
<span class="hljs-built_in">map</span>&lt;pair&lt;<span class="hljs-keyword">int</span>,<span class="hljs-keyword">int</span>&gt;,<span class="hljs-keyword">double</span>&gt; edgeflow;
<span class="hljs-built_in">vector</span>&lt;<span class="hljs-keyword">int</span>&gt; flows;

<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">dijkstra</span><span class="hljs-params">(<span class="hljs-keyword">int</span> source, <span class="hljs-keyword">int</span> destination, <span class="hljs-keyword">int</span> flowmin)</span>
</span>{
  <span class="hljs-built_in">map</span>&lt;<span class="hljs-keyword">int</span>,<span class="hljs-keyword">int</span>&gt; dist;
  <span class="hljs-built_in">set</span>&lt;pair&lt;<span class="hljs-keyword">int</span>,<span class="hljs-keyword">int</span>&gt;&gt; visited;
  visited.insert(make_pair(<span class="hljs-number">0</span>,source));
  <span class="hljs-keyword">while</span> (!visited.empty()) {
    <span class="hljs-keyword">int</span> i = visited.begin()-&gt;second;
    visited.erase(visited.begin());
    <span class="hljs-keyword">if</span> (i == destination) <span class="hljs-keyword">return</span> dist[i];
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">auto</span> j : nbrs[i])
      <span class="hljs-keyword">if</span> (edgeflow[make_pair(i,j)] &gt;= flowmin)
    <span class="hljs-keyword">if</span> (dist.count(j) == <span class="hljs-number">0</span> || dist[i] + edgecost[make_pair(i,j)] &lt; dist[j]) {
      dist[j] = dist[i] + edgecost[make_pair(i,j)];
      visited.insert(make_pair(dist[j],j));
    }
  }
  <span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>;
}

<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-keyword">void</span>)</span>
</span>{
  <span class="hljs-function">ifstream <span class="hljs-title">fin</span> <span class="hljs-params">(<span class="hljs-string">&quot;pump.in&quot;</span>)</span></span>;
  <span class="hljs-function">ofstream <span class="hljs-title">fout</span> <span class="hljs-params">(<span class="hljs-string">&quot;pump.out&quot;</span>)</span></span>;
  fin &gt;&gt; N &gt;&gt; M;
  <span class="hljs-keyword">int</span> i, j, c, f;
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> m=<span class="hljs-number">0</span>; m&lt;M; m++) {
    fin &gt;&gt; i &gt;&gt; j &gt;&gt; c &gt;&gt; f;
    flows.push_back(f);
    nbrs[i].push_back(j);
    nbrs[j].push_back(i);
    edgecost[make_pair(i,j)] = edgecost[make_pair(j,i)] = c;
    edgeflow[make_pair(i,j)] = edgeflow[make_pair(j,i)] = f;
  }
  <span class="hljs-keyword">long</span> <span class="hljs-keyword">long</span> best_num = <span class="hljs-number">0</span>, best_den = <span class="hljs-number">1</span>, cur_num, cur_den;
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> f : flows) {
    cur_num = f;
    cur_den = dijkstra(<span class="hljs-number">1</span>, N, f);
    <span class="hljs-keyword">if</span> (cur_den != <span class="hljs-number">-1</span>) {
      <span class="hljs-keyword">if</span> (cur_num * best_den &gt; best_num * cur_den) {
    best_num = cur_num; best_den = cur_den;
      }
    }
  }
  fout &lt;&lt; best_num * <span class="hljs-number">1000000L</span>L / best_den &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;
  <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}
</code></pre>
<p>The other way to approach this is to augment the vertices to also keep track of the flow rate currently going through the vertex at that point in time. With this approach, you only run Dijkstra&apos;s once, but you have to maintain more information when computing the transitions. Here is my code implementing this approach.</p>
<pre><code>#include &lt;cstring&gt;
#include &lt;iostream&gt;
#include &lt;queue&gt;

using namespace std;

typedef pair&lt;int, int&gt; pii;
typedef pair&lt;int, pii&gt; edge; // &lt;flow, cost&gt;
typedef pair&lt;int, pii&gt; vertex; // &lt;vertex, flow&gt;

int dp[1001][1001];
vector&lt;edge&gt; edges[1001];
int main() {
  freopen(&quot;pump.in&quot;, &quot;r&quot;, stdin);
  freopen(&quot;pump.out&quot;, &quot;w&quot;, stdout);
  memset(dp, 1, sizeof(dp));
  int n, m;
  cin &gt;&gt; n &gt;&gt; m;
  dp[1][1000] = 0;
  while(m--) {
    int a, b, c, f;
    cin &gt;&gt; a &gt;&gt; b &gt;&gt; c &gt;&gt; f;
    edges[a].push_back(edge(b, {f, c}));
    edges[b].push_back(edge(a, {f, c}));
  }
  priority_queue&lt;vertex&gt; q;
  q.push(vertex(0, {1, 1000}));
  double ret = -1;
  while(q.size()) {
    vertex curr = q.top(); q.pop();
    if(curr.second.first == n) {
      ret = max(ret, curr.second.second / (double)dp[curr.second.first][curr.second.second]);
      continue;
    }
    for(edge out: edges[curr.second.first]) {
      int nf = min(out.second.first, curr.second.second);
      int nc = dp[curr.second.first][curr.second.second] + out.second.second;
      int nd = out.first;
      if(nc &lt; dp[nd][nf]) {
        dp[nd][nf] = nc;
        q.push(vertex(-dp[nd][nf], {nd, nf}));
      }
    }
  }
  cout &lt;&lt; (int)(1000000 * ret) &lt;&lt; &quot;\n&quot;;
}
</code></pre>
                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="2019.12.G3.html" class="navigation navigation-prev " aria-label="Previous page: Gold 3">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="2019.12.G2.sol.html" class="navigation navigation-next " aria-label="Next page: Gold 2 solution">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Gold 1 solution","level":"1.2.3.4","depth":3,"next":{"title":"Gold 2 solution","level":"1.2.3.5","depth":3,"path":"2019.12/2019.12.G2.sol.md","ref":"2019.12/2019.12.G2.sol.md","articles":[]},"previous":{"title":"Gold 3","level":"1.2.3.3","depth":3,"path":"2019.12/2019.12.G3.md","ref":"2019.12/2019.12.G3.md","articles":[]},"dir":"ltr"},"config":{"gitbook":"*","theme":"default","variables":{},"plugins":["collapsible-chapters"],"pluginsConfig":{"collapsible-chapters":{},"highlight":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"}},"file":{"path":"2019.12/2019.12.G1.sol.md","mtime":"2020-02-23T13:21:12.000Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2020-03-28T13:38:45.207Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-collapsible-chapters/collapsible-chapters.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

